<app-modal [(isShow)]="showReminderModal" size="md" headerText="Reminder" (onClose)="resetReminderForm()">
  <div body class="p-grid g-margin-x">
    <div class="p-col-12">
      <aps-form-input name="task" id="task" label="Task" [(ngModel)]="reminder.task" [required]="true"></aps-form-input>
    </div>
    <div class="p-md-6 p-sm-12 p-col-12">
      <app-aps-calender name="date" id="date" label="Date" [(ngModel)]="reminder.date"
        [required]="true"></app-aps-calender>
    </div>
    <div class="p-md-6 p-sm-12 p-col-12">
      <app-aps-calender name="time" id="time" label="Time" [timeOnly]="true" [(ngModel)]="reminder.time"
        [required]="true"></app-aps-calender>
    </div>
    <div class="p-col-12 text-right">
      <button class="btn btn-md btn-secondary p-mr-3" (click)="resetReminderForm()">CANCEL</button>
      <button class="btn btn-md btn-primary" (click)="addNewReminder()"
        [disabled]="!reminder.task || !reminder.date || !reminder.time">
        ADD
      </button>
    </div>
  </div>
</app-modal>

<div class="news-feed-container background-color shadow-3 pointer" (click)="openSidebar()">
  <div class="p-pl-3 p-pr-2 p-pt-2 p-pb-1">
    <app-icon icon="fa-newspaper" styleClasses="text-size-20"></app-icon>
  </div>
</div>
<div class="container">
  <div class="p-grid g-margin-x">
    <div class="p-md-9 p-sm-12 p-col-12 p-p-0">
      <div class="p-grid">
        <div class="p-col-12">
          <div class="aps-card">
            <div class="p-grid">
              <div class="p-md-4 p-sm-12 p-col-12 p-py-md-3 p-pl-md-3 p-p-2">
                <div class="background-color-dark-3 p-p-3 aps-h-100p">
                  <div class="text-size-20 text-bold">
                    <app-base-currency [amount]="cxoDashboardData.netBalance" display="code"
                      digitsInfo="1.0-0"></app-base-currency>
                  </div>
                  <div class="text-color-dark-shade-1 text-size-16 text-semi-bold">Net Balance</div>
                </div>
              </div>
              <div class="p-md-4 p-sm-12 p-col-12 p-py-md-3 p-p-2">
                <div class="background-color-success-light p-p-3">
                  <div class="p-grid">
                    <div class="p-col-5 p-p-0">
                      <div class="text-color-dark-shade-1 text-size-16 text-semi-bold">Assets</div>
                    </div>
                    <div class="p-col-7 p-p-0">
                      <div class="text-color-success text-size-20 text-bold">
                        <app-base-currency [amount]="cxoDashboardData.assets" display="code"
                          digitsInfo="1.0-0"></app-base-currency>
                      </div>
                    </div>
                  </div>
                  <div class="p-grid">
                    <div class="p-col-5 p-p-0">
                      <div class="text-color-normal text-size-14">Account Balance</div>
                    </div>
                    <div class="p-col-7 p-p-0">
                      <div class="text-size-16 text-semi-bold">
                        <app-base-currency [amount]="cxoDashboardData.accountBalance" display="code"
                          digitsInfo="1.0-0"></app-base-currency>
                      </div>
                    </div>
                  </div>
                  <div class="p-grid">
                    <div class="p-col-5 p-p-0">
                      <div class="text-color-normal text-size-14">Investments</div>
                    </div>
                    <div class="p-col-7 p-p-0">
                      <div class="text-size-16 text-semi-bold">
                        <app-base-currency [amount]="cxoDashboardData.investments" display="code"
                          digitsInfo="1.0-0"></app-base-currency>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="p-md-4 p-sm-12 p-col-12 p-py-md-3 p-pr-md-3 p-p-2">
                <div class="background-color-danger-light p-p-3 aps-h-100p">
                  <div class="p-grid">
                    <div class="p-col-5 p-p-0">
                      <div class="text-color-dark-shade-1 text-size-16 text-semi-bold">
                        Liabilities
                      </div>
                    </div>
                    <div class="p-col-7 p-p-0">
                      <div class="text-color-danger text-size-20 text-bold">
                        <app-base-currency [amount]="cxoDashboardData.liabilities" display="code"
                          digitsInfo="1.0-0"></app-base-currency>
                      </div>
                    </div>
                  </div>
                  <div class="p-grid">
                    <div class="p-col-5 p-p-0">
                      <div class="text-color-normal text-size-14">Sanctioned</div>
                    </div>
                    <div class="p-col-7 p-p-0">
                      <div class="text-size-16 text-semi-bold">
                        <app-base-currency [amount]="cxoDashboardData.sanctioned" display="code"
                          digitsInfo="1.0-0"></app-base-currency>
                      </div>
                    </div>
                  </div>
                  <div class="p-grid">
                    <div class="p-col-5 p-p-0">
                      <div class="text-color-normal text-size-14">Outstanding</div>
                    </div>
                    <div class="p-col-7 p-p-0">
                      <div class="text-size-16 text-semi-bold">
                        <app-base-currency [amount]="cxoDashboardData.outstanding" display="code"
                          digitsInfo="1.0-0"></app-base-currency>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="p-col-12">
          <div class="inline-items onverflow-x-scroll overflow-y-hidden hide-scroll p-p-1">
            <div class="item p-mr-3" *ngFor="let tab of tabs">
              <div class="aps-card pointer p-p-2 text-size-14" [ngClass]="{ 'aps-card-primary ': currentTab == tab }"
                (click)="currentTab = tab">
                {{ tab }}
              </div>
            </div>
          </div>
        </div>
        <div class="p-col-12" [apsHide]="currentTab != tabs[0]">
          <app-cxo-overall-summary></app-cxo-overall-summary>
        </div>
        <div class="p-col-12" [apsHide]="currentTab != tabs[1]">
          <app-cxo-cashflow-forecast></app-cxo-cashflow-forecast>
        </div>
        <div class="p-col-12" [apsHide]="currentTab != tabs[2]">
          <app-cxo-credit-line-summery></app-cxo-credit-line-summery>
        </div>
        <div class="p-col-12" [apsHide]="currentTab != tabs[3]">
          <app-cxo-miscellaneous></app-cxo-miscellaneous>
        </div>
      </div>
    </div>

    <div class="p-md-3 p-sm-12 p-col-12 p-p-0">
      <div class="p-grid">
        <div class="p-col-12">
          <div class="aps-card p-p-3">
            <app-insights insightsUrl="dummyServer/json/commons/private/insights/cxoDashboard"
              height="80"></app-insights>
          </div>
        </div>

        <div class="p-col-12">
          <div class="aps-card aps-h-500">
            <div class="p-px-3">
              <p-tabView orientation="middle">
                <p-tabPanel header="My Task" headerStyleClass="text-size-14">
                  <div class="aps-h-450 p-pr-1 overflow-y-scroll overflow-x-hidden">
                    <ng-container *ngIf="tasks.length > 0; else nothingHereYetTemplate">
                      <div class="p-py-3 border-bottom" *ngFor="let task of tasks">
                        <div class="text-size-14 text-color-dark-shade-1">
                          {{ task.task }}
                        </div>
                        <div class="text-size-12 text-color-normal" [class]="task.status">
                          Due on {{ task.dueDate | amCalendar }}
                        </div>
                      </div>
                    </ng-container>
                  </div>
                </p-tabPanel>
                <p-tabPanel header="My Reminder" headerStyleClass="text-size-14">
                  <div class="text-size-14 text-bold">Your Tasks for Today</div>
                  <div class="aps-h-370 p-pr-1 overflow-y-scroll overflow-x-hidden">
                    <ng-container *ngIf="reminders.length > 0; else nothingHereYetTemplate">
                      <div class="label-with-icon-container p-py-2" *ngFor="let reminder of reminders">
                        <div class="icon">
                          <app-icon icon="fa-check-circle"></app-icon>
                        </div>
                        <div class="label">
                          <div class="text-size-13">{{ reminder.task }}</div>
                          <div class="text-size-12 text-color-light-shade-1">
                            {{ reminder.dateTime | amCalendar }}
                          </div>
                        </div>
                      </div>
                    </ng-container>
                  </div>

                  <div class="text-right p-pb-3 p-pt-2">
                    <button class="btn btn-md btn-secondary" (click)="showReminderModal = true">
                      <app-icon icon="fa-plus" class="p-mr-2"></app-icon> Add new Task
                    </button>
                  </div>
                </p-tabPanel>
                <p-tabPanel header="Notifications" headerStyleClass="text-size-14">
                  <div class="aps-h-450 p-pr-1 text-color-dark-shade-1 overflow-y-scroll overflow-x-hidden"
                    *ngIf="notifications; else loadingTemplate">
                    <div class="">
                      <div class="text-size-14 text-bold background-color-dark-5 border-radius-4 p-py-1 p-px-3">
                        Today
                      </div>
                      <div class="p-px-2" *ngIf="notifications.today.length > 0; else noNotificationsTemplate">
                        <div class="notification p-px-2 p-py-3 border-bottom"
                          *ngFor="let notification of notifications.today">
                          <div class="text-size-12 text-bold">{{ notification.title }}</div>
                          <div class="text-size-12 p-my-1">
                            {{ notification.notification }}
                          </div>
                          <div class="text-size-10 text-color-normal">
                            {{ notification.dateTime | amCalendar }}
                          </div>
                        </div>
                      </div>
                    </div>
                    <div class="">
                      <div class="text-size-14 text-bold background-color-dark-5 border-radius-4 p-py-1 p-px-3">
                        Yesterday
                      </div>
                      <div class="p-px-2" *ngIf="notifications.yesterday.length > 0; else noNotificationsTemplate">
                        <div class="notification p-px-2 p-py-3 border-bottom"
                          *ngFor="let notification of notifications.yesterday">
                          <div class="text-size-12 text-bold">{{ notification.title }}</div>
                          <div class="text-size-12 p-my-1">
                            {{ notification.notification }}
                          </div>
                          <div class="text-size-10 text-color-normal">
                            {{ notification.dateTime | amCalendar }}
                          </div>
                        </div>
                      </div>
                    </div>
                    <div class="">
                      <div class="text-size-14 text-bold background-color-dark-5 border-radius-4 p-py-1 p-px-3">
                        Earlier
                      </div>
                      <div class="p-px-2" *ngIf="notifications.earlier.length > 0; else noNotificationsTemplate">
                        <div class="notification p-px-2 p-py-3 border-bottom"
                          *ngFor="let notification of notifications.earlier">
                          <div class="text-size-12 text-bold">{{ notification.title }}</div>
                          <div class="text-size-12 p-my-1">
                            {{ notification.notification }}
                          </div>
                          <div class="text-size-10 text-color-normal">
                            {{ notification.dateTime | amCalendar }}
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </p-tabPanel>
              </p-tabView>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<ng-template #nothingHereYetTemplate>
  <app-nothing-here colSize="11"></app-nothing-here>
</ng-template>

<ng-template #loadingTemplate>
  <app-loading-spinner></app-loading-spinner>
</ng-template>

<ng-template #noNotificationsTemplate>
  <p class="py-4 text-size-13 text-center">No Notifications</p>
</ng-template>