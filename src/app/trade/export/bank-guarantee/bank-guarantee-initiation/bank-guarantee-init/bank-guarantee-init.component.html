<div class="container">
  <ng-container *ngIf="!loading; else loadingTemplate">
    <app-search-modal [(isShow)]="searchBeneficiary" header="{{ 'lbl_select_beneficiary' | translate }}"
      colDefUrl="trade/exportTransactions/bankGuarantee/private/beneficiaryColDefs"
      rowDefUrl="trade/exportTransactions/bankGuarantee/private/beneficiaryData"
      (onSelection)="onBeneSelection($event)">
    </app-search-modal>

    <app-modal [(isShow)]="isTermsAndCondition" size="md">
      <div header>
        <div class="left-right-container">
          <div class="left-container">
            <div class="text-size-16 text-semi-bold">
              {{ 'Terms And Conditions' | apsTranslate }}
            </div>
          </div>
        </div>
      </div>
      <div body>
        <div [innerHtml]="
            (termsAndCondition && termsAndCondition[0] ? termsAndCondition[0].description : '')
              | safeHtml
          "></div>
      </div>
      <div footer>
        <div class="left-right-container p-mt-3">
          <div class="left-container"></div>
          <div class="right-container">
            <button class="btn btn-md btn-primary p-px-3" (click)="isTermsAndCondition = false">
              {{ 'CANCEL' | apsTranslate }}
            </button>
          </div>
        </div>
      </div>
    </app-modal>

    <div class="p-grid g-margin-x">
      <div class="p-col-12 p-py-1" style="margin-top: -8px !important">
        <div class="left-right-container">
          <div class="left-container"></div>
          <div class="right-container">
            <div class="left-right-container">
              <div class="left-container">
                <div class="p-px-2 p-py-1 border-radius-4" [ngClass]="
                    parentRef.stepperDetails.steps[0].stepStatus == 'repair' ||
                    parentRef.stepperDetails.steps[3].stepStatus == 'repair'
                      ? 'background-color-warning-light'
                      : 'background-color-success '
                  " *ngIf="repair">
                  <div class="inline-items">
                    <div class="item p-mr-2">
                      <app-icon [icon]="
                          parentRef.stepperDetails.steps[0].stepStatus == 'repair' ||
                          parentRef.stepperDetails.steps[3].stepStatus == 'repair'
                            ? 'fa-exclamation-triangle'
                            : 'fa-check-circle'
                        " [ngClass]="
                          parentRef.stepperDetails.steps[0].stepStatus == 'repair' ||
                          parentRef.stepperDetails.steps[3].stepStatus == 'repair'
                            ? 'text-color-warning'
                            : 'text-color-inverted'
                        " styleClasses="text-size-12"></app-icon>
                    </div>
                    <div class="item p-mr-4" style="padding-top: 2px">
                      <div class="text-size-14 text-semi-bold" [ngClass]="
                          parentRef.stepperDetails.steps[0].stepStatus == 'repair' ||
                          parentRef.stepperDetails.steps[3].stepStatus == 'repair'
                            ? 'text-color-normal'
                            : 'text-color-inverted'
                        ">
                        {{ activeStepIndex == 0 ? '1' : activeStepIndex == 3 ? '2' : '0' }}
                        {{ 'of' | apsTranslate }} 2 {{ 'Corrections made' | apsTranslate }}
                      </div>
                    </div>
                    <div class="item p-mr-3">
                      <app-icon icon="fa-chevron-left" rtlIcon="fa-chevron-right" [styleClasses]="
                          parentRef.stepperDetails.steps[0].stepStatus == 'repair' ||
                          parentRef.stepperDetails.steps[3].stepStatus == 'repair'
                            ? 'text-size-14 text-color-dark-shade-1'
                            : 'text-size-14 text-color-inverted'
                        " (click)="changeRepairStep('previous')"></app-icon>
                    </div>
                    <div class="item p-mr-2">
                      <app-icon icon="fa-chevron-right" rtlIcon="fa-chevron-left" [styleClasses]="
                          parentRef.stepperDetails.steps[0].stepStatus == 'repair' ||
                          parentRef.stepperDetails.steps[3].stepStatus == 'repair'
                            ? 'text-size-14 text-color-dark-shade-1'
                            : 'text-size-14 text-color-inverted'
                        " (click)="changeRepairStep('next')"></app-icon>
                    </div>
                  </div>
                </div>
              </div>

              <div class="right-container p-py-1" *ngIf="viewport === 'web'">
                <div class="inline-items">
                  <div class="item p-px-2">
                    <app-icon icon="fa-refresh"></app-icon>
                  </div>
                  <div class="item p-px-2 border-right">
                    <app-icon icon="fa-print"></app-icon>
                  </div>
                  <div class="item p-px-2">
                    <app-icon icon="fa-user"></app-icon>
                  </div>
                  <div class="item p-px-2">
                    <app-icon icon="fa-link"></app-icon>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="p-md-3 p-sm-12 p-col-12 p-py-1">
        <div class="aps-card text-color-dark-shade-1">
          <div class="left-right-container border-bottom border-radius-4 p-p-3"
            [ngClass]="{ 'active background-color-warning-light': showBankRemarks }" *ngIf="repair"
            (click)="showBankRemarks = true">
            <div class="left-container">
              <div class="text-size-14 text-color-normal text-semi-bold">
                <div class="label-with-icon-container">
                  <div class="icon">
                    <app-icon iconStyle="fas" icon="fa-circle"
                      styleClasses="text-color-warning text-size-12"></app-icon>
                  </div>
                  <div class="label">Bank Remarks (1)</div>
                </div>
              </div>
            </div>
            <div class="right-container">
              <app-icon icon="fa-chevron-right" styleClasses="text-size-14"></app-icon>
            </div>
          </div>
        </div>

        <app-stepper-header [parentRef]="parentRef" stepperType="vertical"
          (stepsReady)="onStepsReady()"></app-stepper-header>
      </div>

      <div class="p-lg-9 p-md-9 p-sm-12 p-col-12 p-py-1">
        <div class="aps-card aps-h-600" *ngIf="parentRef.formData">
          <div class="aps-card-header">
            <div class="left-right-container p-px-3">
              <div class="left-container">
                <div class="text-size-16 text-bold text-color-dark-shade-1 aps-py-12">
                  {{ showBankRemarks ? 'Bank Remarks' : activeStep.displayLabel }}
                </div>
              </div>
              <div class="right-container p-py-2"></div>
            </div>
          </div>

          <div class="aps-card-body p-p-3" *ngIf="showBankRemarks && repair" (click)="showBankRemarks = false">
            <div class="left-right-container p-py-2 p-px-3 border-radius-4 background-color-warning-light">
              <div class="left-container">
                <div class="text-size-12 text-color-normal">
                  The mode of shipment shall be by Sea unless otherwise specified by AT & T on the
                  purchase order. In the absence of specific instructions, seller will select the
                  surface carrier for shipment.
                </div>
              </div>
              <div class="right-container">
                <app-icon icon="fa-info-circle" styleClasses="text-color-warning"></app-icon>
              </div>
            </div>
          </div>

          <div class="aps-card-body p-p-2 overflow-scroll" *ngIf="!showBankRemarks">
            <form name="form1" #form1="ngForm" class="bank-guarantee"
              [apsHide]="activeStep.displayLabel !== parentRef.stepperDetails.headings[0]">
              <div class="p-grid">
                <div class="p-col-12 p-md-4 p-sm-12">
                  <div class="text-size-14 text-semi-bold p-mb-2 text-color-dark-shade-1">
                    {{ 'Issuance For' | apsTranslate }}
                  </div>
                  <p-radioButton class="p-mr-5" name="local" id="local" value="Local" label="Local" [required]="true"
                    [(ngModel)]="parentRef.formData.bankGuaranteeDetails[0].issuanceFor">
                  </p-radioButton>
                  <p-radioButton class="p-mr-5" name="international" id="international" value="International"
                    label="International" [required]="true"
                    [(ngModel)]="parentRef.formData.bankGuaranteeDetails[0].issuanceFor">
                  </p-radioButton>
                </div>
                <div class="p-col-12 p-md-4 p-sm-12">
                  <aps-custom-select name="typeOfApplicationOrUndertaking" id="typeOfApplicationOrUndertaking"
                    [label]="'Type of Application / Undertaking' | apsTranslate"
                    dataUrl="trade/exportTransactions/bankGuarantee/private/dropdown/typeOfApplicationOrUndertaking"
                    [(ngModel)]="parentRef.formData.bankGuaranteeDetails[0].typeOfApplicationOrUndertaking"
                    [required]="true"></aps-custom-select>
                </div>
                <div class="p-col-12 p-md-4 p-sm-12">
                  <aps-custom-select name="applicableRule" id="applicableRule"
                    [label]="'Applicable Rule' | apsTranslate"
                    dataUrl="trade/exportTransactions/bankGuarantee/private/dropdown/applicableRuleDataList"
                    [(ngModel)]="parentRef.formData.bankGuaranteeDetails[0].applicableRule"
                    [required]="true"></aps-custom-select>
                </div>


                <div class="p-col-12 p-md-4 p-sm-12">
                  <aps-custom-select name="adviceMode" id="adviceMode" [label]="'Advice Mode' | apsTranslate"
                    dataUrl="trade/exportTransactions/bankGuarantee/private/dropdown/adviceMode"
                    [(ngModel)]="parentRef.formData.bankGuaranteeDetails[0].adviceMode"
                    [required]="true"></aps-custom-select>
                </div>


                <div class="p-col-12 p-md-4 p-sm-12"
                  *ngIf="parentRef.formData.bankGuaranteeDetails[0].applicableRule == 'OTHR'">
                  <aps-form-input name="description" id="description" label="Description" [required]="true"
                    [(ngModel)]="parentRef.formData.bankGuaranteeDetails[0].description">
                  </aps-form-input>
                </div>
                <div class="p-col-12 p-md-4 p-sm-12">
                  <aps-form-input name="corporateReferenceNo" id="corporateReferenceNo" label="Corporate Ref No"
                    [(ngModel)]="parentRef.formData.bankGuaranteeDetails[0].corporateReferenceNo">
                  </aps-form-input>
                </div>
                <div class="p-col-12 p-md-4 p-sm-12">
                  <div class="left-right-container border-radius-4 background-color-warning-light p-px-3"
                    *ngIf="repair">
                    <div class="left-container">
                      <div class="text-size-12 text-color-normal">
                        Transaction date should be before 14 OCT 2021.
                        <span *ngIf="repairFields.latestDateOfTransactionMessage">
                          Please select Transaction date before 14 OCT 2021.</span>
                      </div>
                    </div>
                    <div class="right-container p-ml-2">
                      <app-icon icon="fa-ellipsis-h" styleClasses="text-color-warning text-size-14" (click)="
                          repairFields.latestDateOfTransactionMessage =
                            !repairFields.latestDateOfTransactionMessage
                        "></app-icon>
                    </div>
                  </div>
                  <app-aps-calender name="transactionDate" id="transactionDate" [showIcon]="true"
                    label="Transaction Date" [defaultDate]="getCurrentDate()"
                    [(ngModel)]="parentRef.formData.bankGuaranteeDetails[0].transactionDate" [required]="true"
                    [helpText]="repair ? repairFields.latestDateOfTransaction : ''">
                  </app-aps-calender>
                </div>
              </div>
            </form>

            <form name="form2" #form2="ngForm" class="applicant-details" [apsHide]="
                activeStep && activeStep.displayLabel !== parentRef.stepperDetails.headings[1]
              ">
              <div class="p-grid">
                <div class="p-lg-4 p-md-4 p-sm-12 p-col-12 p-pb-0">
                  <aps-custom-select name="applicant" id="applicant" [label]="'Applicant' | apsTranslate"
                    dataUrl="trade/exportTransactions/bankGuarantee/private/dropdown/applicantDataList"
                    [required]="true" [value]="parentRef.formData.applicantDetails[0].applicant"
                    [(ngModel)]="parentRef.formData.applicantDetails[0].applicant" (change)="onApplicantClick($event)">
                  </aps-custom-select>
                </div>
              </div>
              <div class="p-grid">
                <div class="p-lg-4 p-md-4 p-sm-12 p-col-12 p-pb-0">
                  <div class="background-color-dark-3 text-size-14 p-px-2 p-py-1 border-radius-4">
                    <div class="text-color-normal">{{ 'Name' | apsTranslate }}</div>
                    <div class="text-color-dark-shade-1">
                      {{ parentRef.formData.applicantDetails[0].applicantName }}
                    </div>
                  </div>
                </div>
                <div class="p-lg-8 p-md-8 p-sm-12 p-col-12 p-pb-0">
                  <div class="background-color-dark-3 text-size-14 p-px-2 p-py-1 border-radius-4">
                    <div class="text-color-normal">{{ 'Email' | apsTranslate }}</div>
                    <div class="text-color-dark-shade-1">
                      {{ parentRef.formData.applicantDetails[0].applicantEmail }}
                    </div>
                  </div>
                </div>
                <div class="p-lg-4 p-md-4 p-sm-12 p-col-12 p-pb-0">
                  <div class="background-color-dark-3 text-size-14 p-px-2 p-py-1 border-radius-4">
                    <div class="text-color-normal">{{ 'Mobile Number' | apsTranslate }}</div>
                    <div class="text-color-dark-shade-1">
                      {{ parentRef.formData.applicantDetails[0].applicantMobileNo }}
                    </div>
                  </div>
                </div>
                <div class="p-lg-8 p-md-8 p-sm-12 p-col-12 p-pb-0">
                  <div class="background-color-dark-3 text-size-14 p-px-2 p-py-1 border-radius-4">
                    <div class="text-color-normal">{{ 'Address' | apsTranslate }}</div>
                    <div class="text-color-dark-shade-1">
                      {{ parentRef.formData.applicantDetails[0].applicantAddress }}
                    </div>
                  </div>
                </div>
              </div>
              <div class="p-grid">
                <div class="p-col-12 p-pt-3">
                  <p-checkbox name="onBehalfOf" id="onBehalfOf" label="On behalf of" [binary]="true"
                    [(ngModel)]="parentRef.formData.applicantDetails[0].onBehalfOf">
                  </p-checkbox>
                </div>
              </div>
              <div class="p-grid" *ngIf="parentRef.formData.applicantDetails[0].onBehalfOf == true">
                <div class="p-col-12 p-md-4 p-lg-4 p-sm-12">
                  <aps-form-input name="name" id="name" label="Name"
                    [(ngModel)]="parentRef.formData.applicantDetails[0].name" [required]="true">
                  </aps-form-input>
                </div>
                <div class="p-col-12 p-md-4 p-lg-4 p-sm-12">
                  <aps-form-input name="telephoneNo" id="telephoneNo" label="Telephone No"
                    [(ngModel)]="parentRef.formData.applicantDetails[0].telephoneNo" [required]="true">
                  </aps-form-input>
                </div>
                <div class="p-col-9 p-py-0">
                  <div class="p-grid">
                    <div class="p-col-12 p-p-0">
                      <aps-form-input name="address1" id="address1" label="Address1"
                        [(ngModel)]="parentRef.formData.applicantDetails[0].address1[0].address"
                        [required]="true"></aps-form-input>
                    </div>
                    <div class="p-col-12 p-p-0" *ngIf="parentRef.formData.applicantDetails[0].address2[0].show">
                      <aps-form-input name="address2" id="address2" label="Address2" [rightIcon]="'fa-trash-alt'"
                        (onRightIcon)="
                          parentRef.formData.applicantDetails[0].address2[0].show = false
                        " [(ngModel)]="parentRef.formData.applicantDetails[0].address2[0].address"></aps-form-input>
                    </div>
                    <div class="p-col-12 p-p-0" *ngIf="parentRef.formData.applicantDetails[0].address3[0].show">
                      <aps-form-input name="address3" id="address3" label="Address3" [rightIcon]="'fa-trash-alt'"
                        (onRightIcon)="
                          parentRef.formData.applicantDetails[0].address3[0].show = false
                        " [(ngModel)]="parentRef.formData.applicantDetails[0].address3[0].address"></aps-form-input>
                    </div>
                  </div>
                </div>
                <div class="p-col-3">
                  <button class="btn text-center btn btn-tertiary" (click)="addApplicantAddress()" [disabled]="
                      parentRef.formData.applicantDetails[0].address1[0].show &&
                      parentRef.formData.applicantDetails[0].address2[0].show &&
                      parentRef.formData.applicantDetails[0].address3[0].show
                    ">
                    <app-icon icon="fa-plus"> </app-icon>&nbsp;{{ 'ADDRESS LINE' | apsTranslate }}
                  </button>
                </div>
              </div>
              <div class="p-grid">
                <div class="p-lg-4 p-md-4 p-sm-12 p-col-12 p-pb-0">
                  <aps-form-input name="nameForClarification" id="nameForClarification" label="Name For Clarification"
                    [(ngModel)]="parentRef.formData.applicantDetails[0].nameForClarification" [required]="true">
                  </aps-form-input>
                </div>
                <div class="p-lg-4 p-md-4 p-sm-12 p-col-12 p-pb-0">
                  <aps-form-input name="mobileNumberForClarification" id="mobileNumberForClarification"
                    label="Mobile Number For Clarification" [(ngModel)]="
                      parentRef.formData.applicantDetails[0].mobileNumberForClarification
                    " [required]="true">
                  </aps-form-input>
                </div>
              </div>
            </form>

            <form name="form3" #form3="ngForm" class="beneficiary-details" [apsHide]="
                activeStep && activeStep.displayLabel !== parentRef.stepperDetails.headings[2]
              ">
              <div class="p-grid">
                <div class="p-col-12">
                  <p-radioButton class="p-mr-6" id="frequencyOfExecution" name="frequencyOfExecution"
                    value="Search Using Beneficiary Code" label="Search Using Beneficiary Code"
                    [(ngModel)]="parentRef.formData.beneficiaryDetails[0].frequencyOfExecution"
                    [required]="true"></p-radioButton>

                  <p-radioButton class="p-mr-4" id="frequencyOfExecution" name="frequencyOfExecution"
                    value="Add New Beneficiary" label="Add New Beneficiary"
                    [(ngModel)]="parentRef.formData.beneficiaryDetails[0].frequencyOfExecution"
                    [required]="true"></p-radioButton>
                </div>

                <div class="p-col-12" *ngIf="!parentRef.formData.beneficiaryDetails[0].frequencyOfExecution">
                  <app-nothing-here colSize="3" message="Enter beneficiary details for preview">
                  </app-nothing-here>
                </div>

                <ng-container *ngIf="
                    parentRef.formData.beneficiaryDetails[0].frequencyOfExecution ===
                    'Search Using Beneficiary Code'
                  ">
                  <div class="p-md-4 p-sm-12 p-col-12">
                    <aps-form-input name="beneficiaryCode" id="beneficiaryCode" label="Beneficiary Code"
                      [required]="true" [rightIcon]="'fa-search'" (onRightIcon)="searchBeneficiary = true"
                      [(ngModel)]="parentRef.formData.beneficiaryDetails[0].beneficiaryCode">
                    </aps-form-input>
                  </div>
                </ng-container>

                <ng-container *ngIf="
                    parentRef.formData.beneficiaryDetails[0].frequencyOfExecution ===
                      'Add New Beneficiary' ||
                    parentRef.formData.beneficiaryDetails[0].beneficiaryCode
                  ">
                  <div class="p-col-12 p-py-0 p-mt-4" *ngIf="
                      parentRef.formData.beneficiaryDetails[0].frequencyOfExecution ===
                      'Add New Beneficiary'
                    ">
                    <div class="text-size-14 text-color-dark-shade-1 text-semi-bold">
                      {{ 'Add New Beneficiary' | apsTranslate }}
                    </div>
                  </div>

                  <div class="p-lg-4 p-md-4 p-sm-12 p-col-12 p-pb-0">
                    <aps-form-input name="beneficiaryName" id="beneficiaryName"
                      [label]="'Beneficiary Name' | apsTranslate" [required]="true"
                      [(ngModel)]="parentRef.formData.beneficiaryDetails[0].beneficiaryName">
                    </aps-form-input>
                  </div>
                  <div class="p-lg-4 p-md-4 p-sm-12 p-col-12 p-pb-0">
                    <aps-form-input name="email" id="email" [label]="'Email' | apsTranslate"
                      [(ngModel)]="parentRef.formData.beneficiaryDetails[0].email" [required]="true"></aps-form-input>
                  </div>
                  <div class="p-lg-4 p-md-4 p-sm-12 p-col-12 p-pb-0">
                    <aps-form-input name="bankSwiftCode" id="bankSwiftCode" [label]="'Bank Swift Code' | apsTranslate"
                      [(ngModel)]="parentRef.formData.beneficiaryDetails[0].bankSwiftCode"
                      [required]="true"></aps-form-input>
                  </div>

                  <div class="p-col-9 p-py-0">
                    <div class="p-grid">
                      <div class="p-col-12 p-p-0">
                        <aps-form-input name="beneficiaryAddress1" id="beneficiaryAddress1"
                          [label]="'Beneficiary Address' | apsTranslate" [(ngModel)]="
                            parentRef.formData.beneficiaryDetails[0].beneficiaryAddress1[0].address
                          " [required]="true">
                        </aps-form-input>
                      </div>
                      <div class="p-col-12 p-p-0"
                        *ngIf="parentRef.formData.beneficiaryDetails[0].beneficiaryAddress2[0].show">
                        <aps-form-input name="beneficiaryAddress2" id="beneficiaryAddress2"
                          [label]="'Beneficiary Address' | apsTranslate" [rightIcon]="'fa-trash-alt'" (onRightIcon)="
                            parentRef.formData.beneficiaryDetails[0].beneficiaryAddress2[0].show = false
                          " [(ngModel)]="
                            parentRef.formData.beneficiaryDetails[0].beneficiaryAddress2[0].address
                          "></aps-form-input>
                      </div>
                      <div class="p-col-12 p-p-0"
                        *ngIf="parentRef.formData.beneficiaryDetails[0].beneficiaryAddress3[0].show">
                        <aps-form-input name="beneficiaryAddress3" id="beneficiaryAddress3"
                          [label]="'Beneficiary Address' | apsTranslate" [rightIcon]="'fa-trash-alt'" (onRightIcon)="
                            parentRef.formData.beneficiaryDetails[0].beneficiaryAddress3[0].show = false
                          " [(ngModel)]="
                            parentRef.formData.beneficiaryDetails[0].beneficiaryAddress3[0].address
                          "></aps-form-input>
                      </div>
                    </div>
                  </div>
                  <div class="p-col-3">
                    <button class="btn text-center btn btn-tertiary" (click)="addBeneficiaryAddress()" [disabled]="
                        parentRef.formData.beneficiaryDetails[0].beneficiaryAddress1[0].show &&
                        parentRef.formData.beneficiaryDetails[0].beneficiaryAddress2[0].show &&
                        parentRef.formData.beneficiaryDetails[0].beneficiaryAddress3[0].show
                      ">
                      <app-icon icon="fa-plus"> </app-icon>&nbsp;{{ 'ADDRESS LINE' | apsTranslate }}
                    </button>
                  </div>
                  <div class="p-md-4 p-sm-12 p-col-12 p-py-0">
                    <aps-form-input name="country" id="country" [label]="'Country' | apsTranslate" [required]="true"
                      [(ngModel)]="parentRef.formData.beneficiaryDetails[0].country">
                    </aps-form-input>
                  </div>
                  <div class="p-md-8 p-sm-12 p-col-12 p-p-0"></div>
                  <div class="p-md-4 p-sm-12 p-col-12 p-py-0">
                    <aps-form-input name="beneficiaryAccountNumber" id="beneficiaryAccountNumber"
                      [label]="'Beneficiary Account Number' | apsTranslate" [(ngModel)]="
                        parentRef.formData.beneficiaryDetails[0].beneficiaryAccountNumber
                      " [required]="true"></aps-form-input>
                  </div>
                  <div class="p-md-8 p-sm-12 p-col-12 p-py-0">
                    <aps-form-input name="beneficiaryBankName" id="beneficiaryBankName"
                      [label]="'Beneficiary Bank Name' | apsTranslate"
                      [(ngModel)]="parentRef.formData.beneficiaryDetails[0].beneficiaryBankName"
                      [required]="true"></aps-form-input>
                  </div>
                  <div class="p-col-9 p-py-0">
                    <div class="p-grid">
                      <div class="p-col-12 p-p-0">
                        <aps-form-input name="beneficiaryBankAddress1" id="beneficiaryBankAddress1"
                          [label]="'Beneficiary Bank Address' | apsTranslate" [(ngModel)]="
                            parentRef.formData.beneficiaryDetails[0].beneficiaryBankAddress1[0]
                              .address
                          " [required]="true"></aps-form-input>
                      </div>
                      <div class="p-col-12 p-p-0" *ngIf="
                          parentRef.formData.beneficiaryDetails[0].beneficiaryBankAddress2[0].show
                        ">
                        <aps-form-input name="beneficiaryBankAddress2" id="beneficiaryBankAddress2"
                          [label]="'Beneficiary Bank Address' | apsTranslate" [(ngModel)]="
                            parentRef.formData.beneficiaryDetails[0].beneficiaryBankAddress2[0]
                              .address
                          " [rightIcon]="'fa-trash-alt'" (onRightIcon)="
                            parentRef.formData.beneficiaryDetails[0].beneficiaryBankAddress2[0].show = false
                          " [required]="true"></aps-form-input>
                      </div>
                      <div class="p-col-12 p-p-0" *ngIf="
                          parentRef.formData.beneficiaryDetails[0].beneficiaryBankAddress3[0].show
                        ">
                        <aps-form-input name="beneficiaryBankAddress3" id="beneficiaryBankAddress3"
                          [label]="'Beneficiary Bank Address' | apsTranslate" [(ngModel)]="
                            parentRef.formData.beneficiaryDetails[0].beneficiaryBankAddress3[0]
                              .address
                          " [rightIcon]="'fa-trash-alt'" (onRightIcon)="
                            parentRef.formData.beneficiaryDetails[0].beneficiaryBankAddress3[0].show = false
                          " [required]="true"></aps-form-input>
                      </div>
                    </div>
                  </div>
                  <div class="p-col-3">
                    <button class="btn text-center btn btn-tertiary" (click)="addBeneficiaryBankAddress()" [disabled]="
                        parentRef.formData.beneficiaryDetails[0].beneficiaryBankAddress1[0].show &&
                        parentRef.formData.beneficiaryDetails[0].beneficiaryBankAddress2[0].show &&
                        parentRef.formData.beneficiaryDetails[0].beneficiaryBankAddress3[0].show
                      ">
                      <app-icon icon="fa-plus"> </app-icon>&nbsp;{{ 'ADDRESS LINE' | apsTranslate }}
                    </button>
                  </div>
                </ng-container>
              </div>
            </form>

            <form name="form4" #form4="ngForm" class="transaction-details"
              [apsHide]="activeStep && activeStep.displayLabel !== parentRef.stepperDetails.headings[3]">
              <div class="p-grid">
                <div class="p-col-12 p-md-4 p-sm-12">
                  <aps-custom-select name="currency" id="currency" [label]="'Currency' | apsTranslate"
                    dataUrl="setup/generalMasters/currency/private/currencyList" [required]="true"
                    [value]="parentRef.formData.transactionDetails[0].currency"
                    [(ngModel)]="parentRef.formData.transactionDetails[0].currency"></aps-custom-select>
                </div>
                <div class="p-col-12 p-md-4 p-sm-12">
                  <div class="left-right-container border-radius-4 background-color-warning-light p-px-3"
                    *ngIf="repair">
                    <div class="left-container">
                      <div class="text-size-12 text-color-normal">
                        Amount should be before 1000.
                        <span *ngIf="repairFields.amountForTransactionMessage">
                          Please enter Amount below 2000.</span>
                      </div>
                    </div>
                    <div class="right-container p-ml-2">
                      <app-icon icon="fa-ellipsis-h" styleClasses="text-color-warning text-size-14" (click)="
                          repairFields.amountForTransactionMessage =
                            !repairFields.amountForTransactionMessage
                        "></app-icon>
                    </div>
                  </div>
                  <aps-form-input name="amount" id="amount" [label]="'Amount' | apsTranslate"
                    inputType="currencyFormatNotZero" [required]="true"
                    [(ngModel)]="parentRef.formData.transactionDetails[0].amount"
                    [helpText]="repair ? repairFields.amountForTransactionCharges : ''">
                  </aps-form-input>
                </div>
                <div class="p-col-12 p-md-4 p-sm-12">
                  <app-aps-calender name="effectiveDate" id="effectiveDate" [label]="'Effective Date' | apsTranslate"
                    [(ngModel)]="parentRef.formData.transactionDetails[0].effectiveDate">
                  </app-aps-calender>
                </div>
                <div class="p-col-12 p-md-4 p-sm-12">
                  <div class="text-size-14 text-semi-bold p-mb-2 text-color-dark-shade-1">
                    {{ 'Validity' | apsTranslate }}
                  </div>
                  <p-radioButton class="p-mr-5" name="fixed" id="fixed" value="Fixed" [label]="'Fixed' | apsTranslate"
                    [required]="true" [(ngModel)]="parentRef.formData.transactionDetails[0].validity">
                  </p-radioButton>
                  <p-radioButton name="openEnded" id="openEnded" value="Open Ended"
                    [label]="'Open Ended' | apsTranslate" [required]="true"
                    [(ngModel)]="parentRef.formData.transactionDetails[0].validity">
                  </p-radioButton>
                </div>
                <div class="p-col-12 p-md-4 p-sm-12">
                  <app-aps-calender name="expiryDate" id="expiryDate" [label]="'Expiry Date' | apsTranslate"
                    [minDate]="getCurrentDate()" [required]="true"
                    [(ngModel)]="parentRef.formData.transactionDetails[0].expiryDate">
                  </app-aps-calender>
                </div>
                <div class="p-col-12 p-md-4 p-sm-12"
                  *ngIf="parentRef.formData.transactionDetails[0].validity == 'Fixed'">
                  <app-aps-calender name="claimExpiryDate" id="claimExpiryDate"
                    [label]="'Claim Expiry Date' | apsTranslate" [minDate]="getCurrentDate()" [required]="true"
                    [(ngModel)]="parentRef.formData.transactionDetails[0].claimExpiryDate">
                  </app-aps-calender>
                </div>
              </div>
              <div class="p-grid">
                <div class="p-col-12 p-md-6 p-sm-12">
                  <div class="text-size-14 text-semi-bold p-mb-2 text-color-dark-shade-1">
                    {{ 'Guarantee Format' | apsTranslate }}
                  </div>
                  <p-radioButton class="p-mr-5" name="asPerBankFormat" id="asPerBankFormat" value="As Per Bank Format"
                    [label]="'As Per Bank Format' | apsTranslate" [required]="true"
                    [(ngModel)]="parentRef.formData.transactionDetails[0].guaranteeFormat">
                  </p-radioButton>
                  <p-radioButton name="asPerAttachment" id="asPerAttachment" value="As Per Attachment"
                    [label]="'As Per Attachment' | apsTranslate" [required]="true"
                    [(ngModel)]="parentRef.formData.transactionDetails[0].guaranteeFormat">
                  </p-radioButton>
                </div>
                <div class="p-col-12 p-md-6 p-sm-12" *ngIf="
                    parentRef.formData.transactionDetails[0].guaranteeFormat == 'As Per Attachment'
                  ">
                  <upload-form-control [hideDragDropContainerOnFIleUpload]="true"
                    [files]="parentRef.formData.transactionDetails[0].supportingDocument" (onUploaded)="
                      parentRef.formData.transactionDetails[0].supportingDocument = $event
                    " [required]="
                      parentRef.formData.transactionDetails[0].guaranteeFormat ==
                      'As Per Attachment'
                    ">
                  </upload-form-control>
                </div>
              </div>
              <div class="p-grid">
                <div class="p-col-12 p-md-6 p-sm-12">
                  <div class="text-size-14 text-semi-bold p-mb-2 text-color-dark-shade-1">
                    {{ 'Preferred Language of Guarantee' | apsTranslate }}<sup>*</sup>
                  </div>
                  <p-radioButton class="p-mr-5" name="english" id="english" value="English"
                    [label]="'English' | apsTranslate" [required]="true"
                    [(ngModel)]="parentRef.formData.transactionDetails[0].preferredLanguageOfGuaranteee">
                  </p-radioButton>
                  <p-radioButton class="p-mr-5" name="local" id="local" value="Local" [label]="'Local' | apsTranslate"
                    [required]="true"
                    [(ngModel)]="parentRef.formData.transactionDetails[0].preferredLanguageOfGuaranteee">
                  </p-radioButton>
                  <p-radioButton name="bilingual" id="bilingual" value="Bilingual"
                    [label]="'Bilingual (English & Local)' | apsTranslate" [required]="true" [(ngModel)]="
                      parentRef.formData.transactionDetails[0].preferredLanguageOfGuaranteee
                    ">
                  </p-radioButton>
                </div>
              </div>
              <div class="text-size-14 text-semi-bold text-color-dark-shade-1 p-px-1 p-pt-3">
                {{ ' Guarantee to be Delivered' | apsTranslate }}
              </div>
              <div class="p-grid">
                <div class="p-col-12 p-md-4 p-lg-4 p-sm-12">
                  <aps-form-input name="name" id="name" [label]="'Name' | apsTranslate"
                    [(ngModel)]="parentRef.formData.transactionDetails[0].name" [required]="true"></aps-form-input>
                </div>
                <div class="p-col-12 p-md-4 p-lg-4 p-sm-12">
                  <aps-form-input name="telephoneNo" id="telephoneNo" [label]="'Telephone No' | apsTranslate"
                    [(ngModel)]="parentRef.formData.transactionDetails[0].telephoneNo"
                    [required]="true"></aps-form-input>
                </div>
                <div class="p-col-12 p-md-4 p-lg-4 p-sm-12">
                  <aps-custom-select name="idProof" id="idProof" [label]="'ID Proof' | apsTranslate"
                    dataUrl="trade/exportTransactions/bankGuarantee/private/dropdown/idProofList" [required]="true"
                    [value]="parentRef.formData.transactionDetails[0].idProof"
                    [(ngModel)]="parentRef.formData.transactionDetails[0].idProof"></aps-custom-select>
                </div>
                <div class="p-col-12 p-md-4 p-lg-4 p-sm-12">
                  <aps-form-input name="purposeOfGuarantee" id="purposeOfGuarantee"
                    [label]="'Purpose Of Guarantee' | apsTranslate"
                    [(ngModel)]="parentRef.formData.transactionDetails[0].purposeOfGuarantee"
                    [required]="true"></aps-form-input>
                </div>
                <div class="p-col-12 p-md-4 p-lg-4 p-sm-12">
                  <aps-custom-select name="accountNumberForCharges" id="accountNumberForCharges"
                    [label]="'Account Number For Charges' | apsTranslate"
                    dataUrl="setup/corporateOnboarding/corporateMain/private/accountList" [required]="true"
                    [value]="parentRef.formData.transactionDetails[0].accountNumberForCharges"
                    [(ngModel)]="parentRef.formData.transactionDetails[0].accountNumberForCharges">
                  </aps-custom-select>
                </div>
                <div class="p-col-12 p-md-4 p-lg-4 p-sm-12">
                  <aps-form-input name="otherInstructions" id="otherInstructions"
                    [label]="'Other Instructions' | apsTranslate"
                    [(ngModel)]="parentRef.formData.transactionDetails[0].otherInstructions"></aps-form-input>
                </div>
              </div>
            </form>

            <form name="form5" #form5="ngForm" class="supporting-documents"
              [apsHide]="activeStep && activeStep.displayLabel !== parentRef.stepperDetails.headings[4]">
              <div class="p-grid">
                <div class="p-md-4 p-sm-12 p-col-12">
                  <div class="text-size-14 text-semi-bold text-color-dark-shade-1">
                    {{ 'Document Type' | apsTranslate }}
                  </div>
                </div>
                <div class="p-md-4 p-sm-12 p-col-12">
                  <div class="text-size-14 text-semi-bold text-color-dark-shade-1">
                    {{ 'Reference Number' | apsTranslate }}
                  </div>
                </div>
                <div class="p-md-4 p-sm-12 p-col-12">
                  <div class="text-size-14 text-semi-bold text-color-dark-shade-1">
                    {{ 'Upload Documents' | apsTranslate }}
                    <span class="text-size-8 text-color-normal">&nbsp;{{ 'Max 10MB each' | apsTranslate }}</span>
                  </div>
                </div>
                <div class="p-md-4 p-sm-12 p-col-12">
                  <p-checkbox name="bgStandard359" id="bgStandard359" [label]="'BG Standard 359' | apsTranslate"
                    [binary]="true" [(ngModel)]="parentRef.formData.supportingDocuments[0].bgStandard359">
                  </p-checkbox>
                </div>
                <div class="p-md-4 p-sm-12 p-col-12 p-py-0">
                  <aps-form-input name="bgStandard359RefNo" id="bgStandard359RefNo"
                    [label]="'Enter Ref. Number' | apsTranslate"
                    [(ngModel)]="parentRef.formData.supportingDocuments[0].bgStandard359RefNo"
                    [required]="parentRef.formData.supportingDocuments[0].bgStandard359"
                    [disabled]="!parentRef.formData.supportingDocuments[0].bgStandard359">
                  </aps-form-input>
                </div>
                <div class="p-md-4 p-sm-12 p-col-12">
                  <upload-form-control [hideDragDropContainerOnFIleUpload]="true"
                    [files]="parentRef.formData.supportingDocuments[0].bgStandard359Document" (onUploaded)="
                      parentRef.formData.supportingDocuments[0].bgStandard359Document = $event
                    " [disabled]="!parentRef.formData.supportingDocuments[0].bgStandard359">
                  </upload-form-control>
                </div>
              </div>
            </form>

            <form name="form6" #form6="ngForm" class="terms-and-condition" [apsHide]="
                activeStep && activeStep.displayLabel !== parentRef.stepperDetails.headings[5]
              ">
              <div class="p-grid">
                <div class="p-col-12">
                  <p-checkbox name="agreeToTermsAndCondition" id="agreeToTermsAndCondition"
                    [label]="'I agree to terms and conditions' | apsTranslate" [binary]="true"
                    [(ngModel)]="parentRef.formData.termsAndCondition[0].agreeToTermsAndCondition"
                    [required]="true"></p-checkbox>
                  <a class="text-size-14 text-bold pointer p-pt-1" (click)="isTermsAndCondition = true">Click Here</a>
                </div>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>
  </ng-container>
</div>

<ng-template #loadingTemplate>
  <app-loading-spinner></app-loading-spinner>
</ng-template>